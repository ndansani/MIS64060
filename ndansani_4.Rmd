---
title: "ndansani_4"
author: "Nadia Dansani"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r pharmaceuticals}
library("stats")
library("dplyr")
library("ggplot2")
library("ggfortify")
getwd()
pharm <-
  read.csv("Pharmaceuticals.csv", header = TRUE, sep = ",")
pharm
pharm
mydata = select(pharm,c(3,4,5,6,7,8,9,10,11))
head(mydata)
mds <- scale(mydata)
head(mds)
wss <- (nrow(mds)-1)*sum(apply(mds,2,var))
wss

for (i in 2:15) wss[i] <- sum(kmeans(mds,centers=i)$withinss)
wss

plot(1:15, wss, type = "b",xlab = "Number of Clusters",ylab = "Sum of squares groups")

#B
fit <- kmeans(mds, 5)

aggregate(mds,by=list(fit$cluster),FUN=mean)

mds1 <- data.frame(mds, fit$cluster)
mds1

library(cluster)
clusplot(mds, fit$cluster, color=TRUE, shade=TRUE, labels=2, lines=0)

wssplot(mydata)
KM = kmeans(mydata,5)
autoplot(KM, mydata,frame=TRUE)
KM$centers
```
#1 Cluster 1 13,15, 7, 10  highest ROA, highest asset turnover
# Cluster 2 5,8,9,12,14,20 highest PE ratio,lowest ROE, lowest ROA, lowest asset turnover, lowest Net profit margin
#Cluster 3 11,17 highest market Cap, highest ROE
#Cluster 4 2,18,6 highest leverage, highest net profit margin, lowest beta, lowest PE ratio, lowest Rev growth
#Cluster 5 3, 16, 19, 21, 1, 4 lowest leverage
 
#C Patterns
#Cluster 2 has mostly buy recommendations, and no sell recommendations
#Cluster 5 mostly hold recommendations
#D
#Clusters can be named based on what was found in b, the quantitative dependent variable



